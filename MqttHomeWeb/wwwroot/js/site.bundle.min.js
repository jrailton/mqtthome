function SubscribeToPush(){navigator.serviceWorker&&navigator.serviceWorker.ready.then(function(n){RegisterPushSubscription(n)})}function Notify(n,t){var r,i;window.notifyContainer||(r=$('<div style="position: fixed; top: 51px; left: 50%; transform: translate(-50%); z-index: 99999;"><\/div>'),$("body").append(r),window.notifyContainer=r);i=$(n);window.notifyContainer.append(i);setTimeout(function(){i.hide(200,function(){i.remove()})},t?t:2e3)}function RegisterPushSubscription(n){return new Promise(function(t,i){n.pushManager.getSubscription().then(function(r){r?(debug&&console.log("Already subscribed to push notifications"),window.subscription=MESSAGING.subscription=r,t(r)):n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:MESSAGING.urlB64ToUint8Array(publicKey)}).then(function(n){n&&(MESSAGING.subscribed=!0,debug&&console.log("Newly subscribed to push notifications"),window.subscription=MESSAGING.subscription=n,DATA.GetSetting("push-notified",!1).then(function(){MESSAGING.PushNotify(n)}),t(n));i()}).catch(function(){MESSAGING.get("/userapi/pushdenied")})})})}function SwitchOff(n){confirm("Are you sure you want to turn "+n+" off?")&&$.get("/switch/off/"+n,function(n){Notify(n)})}function SwitchOn(n){confirm("Are you sure you want to turn "+n+" on?")&&$.get("/switch/on/"+n,function(n){Notify(n)})}$(function(){$("body").tooltip({selector:"[data-toggle=tooltip]",animated:"fade",trigger:"click",delay:{show:500,hide:100}})});